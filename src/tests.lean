import mathematica
import data.rat.basic

open tactic.mathematica
open tactic

meta def s : string :=
"data:image/png;base64,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"


/- AY[Plus][
    AY[Power][
        AY[LeanConst][
            AY[LeanNameMkString][
                T["x"],
                Y[LeanNameAnonymous]
            ],
            Y[LeanLevelListNil]
        ],
        I[2]
    ],
    AY[Times][
        I[-1],
        AY[Power][
            AY[Plus][
                I[1],
                AY[LeanConst][
                    AY[LeanNameMkString][
                        T["x"],
                        Y[LeanNameAnonymous]
                    ],
                    Y[LeanLevelListNil]
                ]
            ],
            I[2]
        ]
    ]
] -/

#exit
constant x : ℤ
run_cmd run_command_on
  (λ s, s ++ " // LeanForm // Activate // FullSimplify") `(x^2 - (x+1)^2)
>>= to_expr >>= trace

#exit

import tactic.core

section

setup_tactic_parser

@[user_command] meta def widget_test (_ : parse (tk "widgety")) : lean.parser unit :=
_

end

widgety